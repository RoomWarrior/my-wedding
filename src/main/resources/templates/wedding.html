<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Invitation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/styles.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Bad+Script&family=Caveat:wght@400..700&family=Marck+Script&display=swap&family=Neucha&display=swap"
          rel="stylesheet">
    <link rel="icon" href="/images/favicon.svg" type="image/svg+xml">
</head>
<body>
<div class="wedding-header">
    <div class="flex items-center justify-center">
        <div class="relative animate-on-scroll">
            <div class="photo-wrapper">
                <img class="image" alt="we" src="/images/img.png">
            </div>
        </div>
    </div>
    <h1 class="animate-on-scroll">–ú—ã - –ê—Ä—Ç—É—Ä –∏ –ö–∞—Ä–∏–Ω–∞</h1>
    <h3 class="animate-on-scroll">–ò –º—ã —Ä–µ—à–∏–ª–∏ –ø–æ–∂–µ–Ω–∏—Ç—å—Å—è –∏ –ø–æ–∑–≤–∞—Ç—å –∏–º–µ–Ω–Ω–æ –≤–∞—Å!</h3>
    <div class="wedding-details animate-on-scroll">
        <h2 class="lead">–î–æ—Ä–æ–≥–∏–µ –¥—Ä—É–∑—å—è!</h2>
        <p>–ú—ã —Ä–∞–¥—ã –ø—Ä–∏–≥–ª–∞—Å–∏—Ç—å –≤–∞—Å —Ä–∞–∑–¥–µ–ª–∏—Ç—å —Å –Ω–∞–º–∏ —Å–∞–º—ã–π –≤–∞–∂–Ω—ã–π –¥–µ–Ω—å –≤ –Ω–∞—à–µ–π –∂–∏–∑–Ω–∏.</p>
        <p>–≠—Ç–æ –±—É–¥–µ—Ç –æ—Å–æ–±–µ–Ω–Ω—ã–π –ø—Ä–∞–∑–¥–Ω–∏–∫, –Ω–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã–π –ª—é–±–æ–≤—å—é, —Ä–∞–¥–æ—Å—Ç—å—é –∏ —Å—á–∞—Å—Ç—å–µ–º, –∞ –∫–∞–∂–¥—ã–π –∏–∑ –≤–∞—Å - –≤–∞–∂–Ω–∞—è –µ–≥–æ
            —á–∞—Å—Ç—å.</p>
        <p>–ü—É—Å—Ç—å —ç—Ç–æ—Ç –¥–µ–Ω—å –∑–∞–ø–æ–º–Ω–∏—Ç—Å—è —Ç–µ–ø–ª–æ–º, —è—Ä–∫–∏–º–∏ –º–æ–º–µ–Ω—Ç–∞–º–∏ –∏ —Å–º–µ—Ö–æ–º</p>
    </div>
    <div class="wedding-details animate-on-scroll" >
        <h2 class="lead">–ü—Ä–æ–≥—Ä–∞–º–º–∞ —Ç–æ—Ä–∂–µ—Å—Ç–≤–∞</h2>
        <div class="timeline">
            <div class="timeline-item animate-on-scroll">
                <img src="/images/champagne.svg" alt="–¶–µ—Ä–µ–º–æ–Ω–∏—è">
                <div class="time">15:00</div>
	            <div class="event">–°–±–æ—Ä –≥–æ—Å—Ç–µ–π, —Ñ—É—Ä—à–µ—Ç</div>
            </div>
            <div class="timeline-item animate-on-scroll">
                <img src="/images/arch.svg" alt="–¶–µ—Ä–µ–º–æ–Ω–∏—è">
                <div class="time">16:00</div>
	            <div class="event">–¶–µ—Ä–µ–º–æ–Ω–∏—è</div>
            </div>
            <div class="timeline-item animate-on-scroll">
                <img src="/images/cake.svg" alt="–ë–∞–Ω–∫–µ—Ç">
                <div class="time">17:00</div>
                <div class="event">–ü—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –±–∞–Ω–∫–µ—Ç</div>
            </div>
            <div class="timeline-item animate-on-scroll">
                <img src="/images/saxophone.svg" alt="After party">
                <div class="time">18:00</div>
                <div class="event">–ú—É–∑—ã–∫–∞, —Ç–∞–Ω—Ü—ã, –≤–µ—Å–µ–ª—å–µ!</div>
            </div>
        </div>
    </div>
    <div class="wedding-details animate-on-scroll">
        <h2 class="lead">–ú—ã –±—É–¥–µ–º –∂–¥–∞—Ç—å –≤–∞—Å</h2>
        <p>16 –∞–≤–≥—É—Å—Ç–∞ 2025 –≥–æ–¥–∞</p>
        <a href="https://2gis.kg/bishkek/firm/70000001079683718?m=74.67647%2C42.680937%2F16" target="_blank">Mountain
            View Resort</a>
        <h2 class="lead">–î—Ä–µ—Å—Å-–∫–æ–¥</h2>
        <p>–ú—ã –±—É–¥–µ–º –æ—á–µ–Ω—å —Ä–∞–¥—ã, –µ—Å–ª–∏ –≤—ã –ø–æ–¥–¥–µ—Ä–∂–∏—Ç–µ –Ω–∞—Å –≤–∞—à–∏–º–∏ —É–ª—ã–±–∫–∞–º–∏ –∏ –æ–±—ä—è—Ç–∏—è–º–∏, –∞ —Ç–∞–∫–∂–µ –∫—Ä–∞—Å–∏–≤—ã–º–∏ –Ω–∞—Ä—è–¥–∞–º–∏ –≤ –ø–∞–ª–∏—Ç—Ä–µ
            —Ç–æ—Ä–∂–µ—Å—Ç–≤–∞</p>

        <div class="color-palette">
            <div class="color-swatch" style="background-color: #809671;"></div>
            <div class="color-swatch" style="background-color: #B3B792;"></div>
            <div class="color-swatch" style="background-color: #E5E0D8;"></div>
            <div class="color-swatch" style="background-color: #E5D2B8;"></div>
            <div class="color-swatch" style="background-color: #D2AB80;"></div>
            <div class="color-swatch" style="background-color: #725C3A;"></div>
        </div>
    </div>
</div>
<div class="flex items-center justify-center images-wrapper">
    <div class="animate-on-scroll parent-wrapper">
        <div class="photo-wrapper-both img-1">
            <img class="image" alt="we" src="/images/img_1.png">
        </div>
        <div class="photo-wrapper-both img-2">
            <img class="image" alt="we" src="/images/img_2.png">
        </div>
    </div>
</div>
<div class="container-rsvp">
    <div class="rsvp-form animate-on-scroll" id="rsvpFormContainer">
        <h2 class="text-center mb-4">RSVP</h2>
        <div id="loadingIndicator" class="text-center mb-3" style="display: none;">
            <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <p class="mt-2">–û—Ç–ø—Ä–∞–≤–∫–∞ —Ñ–æ—Ä–º—ã...</p>
        </div>
        <form th:action="@{/rsvp}" th:object="${guest}" method="post" id="rsvpForm">
            <div class="mb-4">
                <label for="name" class="form-label">–í–∞—à–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—è <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="name" th:field="*{name}"
                       required>
                <div class="invalid-feedback" id="nameError" style="display: none;">–ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∞—à–∏ –∏–º—è –∏
                    —Ñ–∞–º–∏–ª–∏—é —Ä—É—Å—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤)
                </div>
            </div>
            <div class="mb-4">
                <label for="relationType" class="form-label">–ö–µ–º –≤—ã –ø—Ä–∏—Ö–æ–¥–∏—Ç–µ—Å—å –º–æ–ª–æ–¥–æ–∂–µ–Ω–∞–º? <span
                        class="text-danger">*</span></label>
                <select class="form-control" id="relationType" name="relationType" required>
                    <option value="" disabled selected>–í—ã–±–µ—Ä–∏—Ç–µ</option>
                    <option th:each="type : ${T(dev.roomwarrior.wedding.enums.RelationType).values()}"
                            th:value="${type}"
                            th:text="${type.displayName}"
                            th:selected="${guest.relationType == type}">–¢–∏–ø –æ—Ç–Ω–æ—à–µ–Ω–∏–π
                    </option>
                </select>
            </div>
            <div class="mb-4">
                <label class="form-label">–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—Ä–∏–∞–Ω—Ç <span class="text-danger">*</span></label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="attending" id="attendingYes"
                           th:field="*{attending}" th:value="YES" required>
                    <label class="form-check-label" for="attendingYes">
                        –Ø –ø—Ä–∏–¥—É
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="attending" id="attendingPlusOne"
                           th:field="*{attending}" th:value="PLUS_ONE" required>
                    <label class="form-check-label" for="attendingPlusOne">
                        –Ø –ø—Ä–∏–¥—É —Å +1
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="attending" id="attendingNo"
                           th:field="*{attending}" th:value="NO" required>
                    <label class="form-check-label" for="attendingNo">
                        –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, –Ω–µ —Å–º–æ–≥—É –ø—Ä–∏–π—Ç–∏
                    </label>
                </div>
            </div>
            <div class="mb-4" id="plusOneNameDiv" style="display: none;">
                <label for="plusOneName" class="form-label">–ò–º—è –∏ —Ñ–∞–º–∏–ª–∏—è +1 <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="plusOneName" th:field="*{plusOneName}">
                <div class="invalid-feedback" id="plusOneNameError" style="display: none;">–ù–∞–ø–∏—à–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏–º—è –∏
                    —Ñ–∞–º–∏–ª–∏—é –≤–∞—à–µ–≥–æ +1 —Ä—É—Å—Å–∫–∏–º–∏ –±—É–∫–≤–∞–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä: –ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤)
                </div>
            </div>
            <div class="mb-4" id="transportDiv" style="display: none;">
                <label class="form-label">–ö–∞–∫ –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –¥–æ–±—Ä–∞—Ç—å—Å—è? <span class="text-danger">*</span></label>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="needsTransport" id="transportNo"
                           th:field="*{needsTransport}" th:value="false" required>
                    <label class="form-check-label" for="transportNo">
                        –î–æ–±–µ—Ä—É—Å—å —Å–≤–æ–∏–º —Ö–æ–¥–æ–º
                    </label>
                </div>
                <div class="form-check">
                    <input class="form-check-input" type="radio" name="needsTransport" id="transportYes"
                           th:field="*{needsTransport}" th:value="true" required>
                    <label class="form-check-label" for="transportYes">
                        –ù–∞—à–∏–º —Ç—Ä–∞–Ω—Å—Ñ–µ—Ä–æ–º
                    </label>
                </div>
            </div>
            <div class="mb-4">
                <label for="message" class="form-label">–°–æ–æ–±—â–µ–Ω–∏–µ –¥–ª—è –º–æ–ª–æ–¥–æ–∂–µ–Ω–æ–≤ </label>
                <textarea style="resize: none;" class="form-control" id="message" th:field="*{message}"
                          rows="3"></textarea>
            </div>
            <button type="submit" class="btn-action btn-primary w-100" id="submitButton">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
        </form>
    </div>
</div>
    <div class="wedding-bottom">
        <div class="wedding-details animate-on-scroll">

            <h2 class="lead">–ö—Å—Ç–∞—Ç–∏</h2>
            <p>–ú—ã –Ω–µ –ª—é–±–∏–º —Ü–≤–µ—Ç—ã, –Ω–æ –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ —Å–¥–µ–ª–∞—Ç—å –Ω–∞–º –ø—Ä–∏—è—Ç–Ω–æ, —Ç–æ <span style="color: var(--mountain-blue)">–í–ú–ï–°–¢–û</span> —Ü–≤–µ—Ç–æ–≤, –º—ã –±—É–¥–µ–º –æ—á–µ–Ω—å —Ä–∞–¥—ã —á–µ–º—É-–Ω–∏–±—É–¥—å –∏–∑ –Ω–∞—à–µ–≥–æ –≤–∏—à –ª–∏—Å—Ç–∞</p>
            <a href="https://followish.io/mywishlist/gulc04s3lbwbmt"><button class="btn-action">–í–∏—à–ª–∏—Å—Ç</button></a>
        </div>
    </div>
    <footer class="wedding-footer text-center mt-5 mb-3 animate-on-scroll">
        <p class="mb-2" style="font-size: 1.2rem; font-weight: 100">
            –°–¥–µ–ª–∞–Ω–æ —Å –ª—é–±–æ–≤—å—é, –ê—Ä—Ç—É—Ä–æ–º –∏ –ö–∞—Ä–∏–Ω–æ–π üíç
        </p>
        <p style="font-size: 0.9rem;">¬© 2025 –í—Å–µ –ø—Ä–∞–≤–∞ –∑–∞—â–∏—â–µ–Ω—ã</p>

        <button onclick="scrollToTop()" class="btn-action animate-on-scroll">‚Üë –ù–∞–≤–µ—Ä—Ö</button>
    </footer>
</body>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script>

    document.addEventListener("DOMContentLoaded", function () {
        const observer = new IntersectionObserver(entries => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    entry.target.classList.add('visible');
                    observer.unobserve(entry.target); // –ê–Ω–∏–º–∞—Ü–∏—è –æ–¥–∏–Ω —Ä–∞–∑
                }
            });
        }, {
            threshold: 0.1
        });

        document.querySelectorAll('.animate-on-scroll').forEach(el => {
            observer.observe(el);
        });
    });



    const attendingPlusOne = document.getElementById('attendingPlusOne');
    const attendingYes = document.getElementById('attendingYes');
    const attendingNo = document.getElementById('attendingNo');
    const plusOneNameDiv = document.getElementById('plusOneNameDiv');
    const transportDiv = document.getElementById('transportDiv');
    const plusOneNameInput = document.getElementById('plusOneName');
    const form = document.getElementById('rsvpForm');
    const submitButton = document.getElementById('submitButton');
    const nameInput = document.getElementById('name');
    const nameError = document.getElementById('nameError');
    const plusOneInputError = document.getElementById('plusOneNameError');


    function validateName(name) {
        const nameRegex = /^[–ê-–Ø–∞-—è–Å—ë]+ [–ê-–Ø–∞-—è–Å—ë]+$/;
        return nameRegex.test(name.trim());
    }

    nameInput.addEventListener('input', function() {
        if (!validateName(this.value)) {
            this.classList.add('is-invalid');
            nameError.style.display = 'block';
        } else {
            this.classList.remove('is-invalid');
            nameError.style.display = 'none';
        }
    });

    nameInput.addEventListener('blur', function() {
        if (!validateName(this.value)) {
            this.classList.add('is-invalid');
            nameError.style.display = 'block';
        }
    });

    plusOneNameInput.addEventListener('input', function() {
        if (attendingPlusOne.checked && !validateName(this.value)) {
            this.classList.add('is-invalid');
            plusOneInputError.style.display = 'block';
        } else {
            this.classList.remove('is-invalid');
            plusOneInputError.style.display = 'none';
        }
    })

    plusOneNameInput.addEventListener('blur', function() {
        if (attendingPlusOne.checked && !validateName(this.value)) {
            this.classList.add('is-invalid');
            plusOneInputError.style.display = 'block';
        }
    })


    function updateFormFields() {
        const isAttending = attendingYes.checked || attendingPlusOne.checked;

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –ø–æ–ª–µ –¥–ª—è –∏–º–µ–Ω–∏ +1
        if (attendingPlusOne.checked) {
            plusOneNameDiv.style.display = 'block';
            plusOneNameInput.setAttribute('required', 'required');
        } else {
            plusOneNameDiv.style.display = 'none';
            plusOneNameInput.removeAttribute('required');
            if (!attendingPlusOne.checked) {
                plusOneNameInput.value = '';
            }
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º/—Å–∫—Ä—ã–≤–∞–µ–º –≤—ã–±–æ—Ä —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞
        if (isAttending) {
            transportDiv.style.display = 'block';
            document.querySelectorAll('input[name="needsTransport"]').forEach(radio => {
                radio.setAttribute('required', 'required');
            });
        } else {
            transportDiv.style.display = 'none';
            document.querySelectorAll('input[name="needsTransport"]').forEach(radio => {
                radio.removeAttribute('required');
                radio.checked = false;
            });
        }
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è —Ñ–æ—Ä–º—ã
    form.addEventListener('submit', function (e) {
        e.preventDefault();

        if (!validateName(nameInput.value.trim())) {
            return;
        }

        if (attendingPlusOne.checked && !validateName(plusOneNameInput.value.trim())) {
            return;
        }

        if (attendingPlusOne.checked && !plusOneNameInput.value.trim()) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —É–∫–∞–∂–∏—Ç–µ –∏–º—è +1');
            return;
        }

        const isAttending = attendingYes.checked || attendingPlusOne.checked;
        if (isAttending && !document.querySelector('input[name="needsTransport"]:checked')) {
            alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞');
            return;
        }

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
        const loadingIndicator = document.getElementById('loadingIndicator');
        loadingIndicator.style.display = 'block';
        submitButton.disabled = true;

        // –°–æ–±–∏—Ä–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Ñ–æ—Ä–º—ã
        const formData = new FormData(form);

        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ñ–æ—Ä–º—É —á–µ—Ä–µ–∑ AJAX
        fetch(form.action, {
            method: 'POST',
            body: formData
        })
            .then(response => {
                if (response.ok) {
                    const formElements = form.elements;
                    for (let i = 0; i < formElements.length; i++) {
                        formElements[i].disabled = true;
                    }
                    document.body.style.overflow = 'hidden'
                    const alertDiv = document.createElement('div');
                    alertDiv.className = 'modal';
                    alertDiv.id = 'thankYouModal'
                    alertDiv.role = 'modal';
                    alertDiv.innerHTML = `
                   <div class="modal-content" style="font-family: 'Caveat', cursive">
                            <span class="close" onclick="closeModal()">&times;</span>
                            <p>–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à –æ—Ç–≤–µ—Ç!<br>` + (attendingNo ? `–ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏—Ç–µ –≤–∞—à–µ —Ä–µ—à–µ–Ω–∏–µ, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ —Ñ–æ—Ä–º—É –µ—â–µ —Ä–∞–∑` : `–ú—ã –±—É–¥–µ–º —Ä–∞–¥—ã –≤–∏–¥–µ—Ç—å –≤–∞—Å –Ω–∞ –Ω–∞—à–µ–π —Å–≤–∞–¥—å–±–µ!`) +
                        `</p></div>`;
                    document.body.appendChild(alertDiv);

                    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                    loadingIndicator.style.display = 'none';

                } else {
                    throw new Error('–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã');
                }
            })
            .catch(error => {
                alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ —Ñ–æ—Ä–º—ã. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑.');
                submitButton.disabled = false;
                loadingIndicator.style.display = 'none';
            });
    });

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    updateFormFields();

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤—ã–±–æ—Ä–∞
    document.querySelectorAll('input[name="attending"]').forEach(radio => {
        radio.addEventListener('change', updateFormFields);
    });

    function closeModal() {
        document.getElementById("thankYouModal").style.display = "none";
        document.body.style.overflow = ''
    }

    function scrollToTop() {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    }
</script>
</body>
</html>
