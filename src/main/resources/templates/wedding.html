<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Wedding Invitation</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2C3E50;  /* Глубокий синий гор */
            --accent-color: #E67E22;   /* Теплый оранжевый заката */
            --text-color: #34495E;     /* Темно-синий текст */
            --light-bg: #ECF0F1;       /* Светлый фон */
            --nature-green: #27AE60;   /* Зеленый лес */
            --soft-green: #2ECC71;     /* Светлый зеленый */
            --mountain-blue: #3498DB;  /* Синий неба */
            --rock-brown: #7F8C8D;     /* Серый скал */
            --sunset-orange: #E67E22;  /* Оранжевый заката */
            --mountain-purple: #8E44AD; /* Фиолетовый горных вершин */
        }

        body {
            background-color: var(--light-bg);
            font-family: 'Montserrat', sans-serif;
            color: var(--text-color);
            line-height: 1.6;
            font-size: 16px;
        }

        .wedding-header {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(rgba(255,255,255,0.85), rgba(255,255,255,0.85)), 
                        url('https://images.unsplash.com/photo-1519741497674-611481863552?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            margin-bottom: 30px;
            position: relative;
        }

        .wedding-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1464822759023-fed622ff2c3b?ixlib=rb-1.2.1&auto=format&fit=crop&w=1350&q=80');
            background-size: cover;
            background-position: center;
            opacity: 0.15;
            z-index: -1;
        }

        .wedding-header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 1rem;
            font-weight: 500;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
        }

        .wedding-header .lead {
            font-size: 1.5rem;
            color: var(--mountain-blue);
            font-weight: 500;
            margin-bottom: 1.5rem;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.8);
        }

        .wedding-header p {
            font-size: 1.2rem;
            color: var(--text-color);
            margin-bottom: 0.5rem;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        .wedding-details {
            background: rgba(255, 255, 255, 0.9);
            padding: 1.5rem;
            border-radius: 15px;
            margin: 1.5rem auto;
            max-width: 600px;
            border: 1px solid rgba(52, 152, 219, 0.2);
        }

        .wedding-details h3 {
            font-family: 'Playfair Display', serif;
            color: var(--mountain-blue);
            font-size: 1.3rem;
            margin-bottom: 1rem;
            font-weight: 500;
        }

        .wedding-details p {
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .wedding-details .highlight {
            color: var(--sunset-orange);
            font-weight: 500;
        }

        .wedding-details .transport-options {
            margin-top: 1.5rem;
            padding-top: 1.5rem;
            border-top: 1px solid rgba(52, 152, 219, 0.2);
        }

        .wedding-details .transport-option {
            margin-bottom: 1rem;
        }

        .wedding-details .transport-option:last-child {
            margin-bottom: 0;
        }

        .rsvp-form {
            max-width: 600px;
            margin: 0 auto;
            padding: 30px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            position: relative;
            overflow: hidden;
        }

        .rsvp-form::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
            background: linear-gradient(to right, var(--mountain-blue), var(--sunset-orange));
        }

        .rsvp-form h2 {
            font-family: 'Playfair Display', serif;
            color: var(--primary-color);
            margin-bottom: 1.5rem;
            font-weight: 500;
            font-size: 1.8rem;
        }

        .form-label {
            font-weight: 500;
            color: var(--primary-color);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .form-control {
            border: 2px solid #E0E0E0;
            border-radius: 10px;
            padding: 15px;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        .form-control:focus {
            border-color: var(--mountain-blue);
            box-shadow: 0 0 0 0.2rem rgba(52, 152, 219, 0.1);
        }

        .form-check-input:checked {
            background-color: var(--mountain-blue);
            border-color: var(--mountain-blue);
        }

        .btn-primary {
            background: linear-gradient(to right, var(--mountain-blue), var(--sunset-orange));
            border: none;
            padding: 15px;
            font-weight: 500;
            font-size: 1.1rem;
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.2);
        }

        .alert-success {
            background-color: rgba(46, 204, 113, 0.1);
            border: 1px solid var(--nature-green);
            border-radius: 10px;
            color: var(--nature-green);
            padding: 1rem;
            margin-bottom: 1.5rem;
            font-size: 1.1rem;
        }

        .text-danger {
            color: var(--sunset-orange) !important;
        }

        .form-check {
            margin-bottom: 1rem;
        }

        .form-check-input {
            width: 1.2rem;
            height: 1.2rem;
            margin-top: 0.2rem;
        }

        .form-check-label {
            font-size: 1.1rem;
            padding-left: 0.5rem;
        }

        textarea.form-control {
            min-height: 100px;
        }

        /* Стили для неактивных полей после отправки */
        .form-control:disabled,
        .form-check-input:disabled {
            background-color: #f8f9fa;
            opacity: 0.8;
        }

        .btn-primary:disabled {
            background: linear-gradient(to right, #ccc, #999);
            transform: none;
            box-shadow: none;
        }

        /* Медиа-запросы для мобильных устройств */
        @media (max-width: 768px) {
            .wedding-header {
                padding: 40px 15px;
            }

            .wedding-header h1 {
                font-size: 2rem;
            }

            .wedding-header .lead {
                font-size: 1.3rem;
            }

            .wedding-header p {
                font-size: 1.1rem;
            }

            .wedding-details {
                padding: 1.2rem;
                margin: 1rem 15px;
            }

            .wedding-details h3 {
                font-size: 1.2rem;
            }

            .wedding-details p {
                font-size: 1rem;
            }

            .rsvp-form {
                padding: 20px 15px;
                margin: 0 15px;
            }

            .rsvp-form h2 {
                font-size: 1.5rem;
            }

            .form-label {
                font-size: 1rem;
            }

            .form-control {
                padding: 12px;
                font-size: 1rem;
            }

            .form-check-label {
                font-size: 1rem;
            }

            .btn-primary {
                padding: 12px;
                font-size: 1rem;
            }
        }

        @media (max-width: 480px) {
            .wedding-header h1 {
                font-size: 1.8rem;
            }

            .wedding-header .lead {
                font-size: 1.2rem;
            }

            .wedding-header p {
                font-size: 1rem;
            }

            .form-control {
                font-size: 16px; /* Предотвращает масштабирование на iOS */
            }

            .form-check-input {
                width: 1.1rem;
                height: 1.1rem;
            }

            .form-check-label {
                font-size: 0.95rem;
            }
        }

        /* Добавляем стили для палитры цветов */
        .color-palette {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 12px 0;
            justify-content: center;
        }

        .color-swatch {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.2s ease;
        }

        .color-swatch:hover {
            transform: scale(1.1);
        }

        @media (max-width: 480px) {
            .color-swatch {
                width: 35px;
                height: 35px;
            }
        }

    </style>
</head>
<body>
    <div class="wedding-header">
        <h1>Артур & Карина</h1>
        <p class="lead">Приглашаем вас на нашу свадьбу</p>
        <p>16 августа 2025 года</p>
        <p>Mountain View Resort</p>
        
        <div class="wedding-details">
            <h3>Дресс-код</h3>
            <p>Мы будем рады видеть вас в <span class="highlight">пастельных тонах</span></p>
            <div class="color-palette">
                <div class="color-swatch" style="background-color: #FFB3BA;"></div>
                <div class="color-swatch" style="background-color: #BAFFC9;"></div>
                <div class="color-swatch" style="background-color: #BAE1FF;"></div>
                <div class="color-swatch" style="background-color: #FFFFBA;"></div>
                <div class="color-swatch" style="background-color: #FFE4BA;"></div>
                <div class="color-swatch" style="background-color: #E4BAFF;"></div>
            </div>
            
            <h3>Пожелания</h3>
            <p>Вместо цветов мы будем рады вашему присутствию и теплым пожеланиям</p>

        </div>
    </div>

    <div class="container">
        <div class="rsvp-form">
            <h2 class="text-center mb-4">RSVP</h2>
            <div th:if="${success}" class="alert alert-success alert-dismissible fade show" role="alert">
                Спасибо за ваш ответ! Мы будем рады видеть вас на нашей свадьбе!
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            <form th:action="@{/rsvp}" th:object="${guest}" method="post" id="rsvpForm">
                <div class="mb-4">
                    <label for="name" class="form-label">Ваше имя <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="name" th:field="*{name}" required>
                </div>
                <div class="mb-4">
                    <label for="relationType" class="form-label">Кем вы приходитесь молодоженам? <span class="text-danger">*</span></label>
                    <select class="form-control" id="relationType" name="relationType" required>
                        <option value="" disabled selected>Выберите</option>
                        <option th:each="type : ${T(dev.roomwarrior.wedding.enums.RelationType).values()}"
                                th:value="${type}"
                                th:text="${type.displayName}"
                                th:selected="${guest.relationType == type}">Тип отношений</option>
                    </select>
                </div>
                <div class="mb-4">
                    <label class="form-label">Выберите вариант <span class="text-danger">*</span></label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="attending" id="attendingYes" th:field="*{attending}" th:value="YES" required>
                        <label class="form-check-label" for="attendingYes">
                            Я приду
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="attending" id="attendingPlusOne" th:field="*{attending}" th:value="PLUS_ONE" required>
                        <label class="form-check-label" for="attendingPlusOne">
                            Я приду с +1
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="attending" id="attendingNo" th:field="*{attending}" th:value="NO" required>
                        <label class="form-check-label" for="attendingNo">
                            К сожалению, не смогу прийти
                        </label>
                    </div>
                </div>
                <div class="mb-4" id="plusOneNameDiv" style="display: none;">
                    <label for="plusOneName" class="form-label">Имя +1 <span class="text-danger">*</span></label>
                    <input type="text" class="form-control" id="plusOneName" th:field="*{plusOneName}">
                </div>
                <div class="mb-4" id="transportDiv" style="display: none;">
                    <label class="form-label">Как вы планируете добраться? <span class="text-danger">*</span></label>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="needsTransport" id="transportNo" th:field="*{needsTransport}" th:value="false" required>
                        <label class="form-check-label" for="transportNo">
                            Доберусь своим ходом
                        </label>
                    </div>
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="needsTransport" id="transportYes" th:field="*{needsTransport}" th:value="true" required>
                        <label class="form-check-label" for="transportYes">
                            Нашим трансфером
                        </label>
                    </div>
                </div>
                <div class="mb-4">
                    <label for="message" class="form-label">Сообщение для молодоженов </label>
                    <textarea style="resize: none;" class="form-control" id="message" th:field="*{message}" rows="3"></textarea>
                </div>
                <button type="submit" class="btn btn-primary w-100" id="submitButton">Отправить</button>
            </form>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        const attendingPlusOne = document.getElementById('attendingPlusOne');
        const attendingYes = document.getElementById('attendingYes');
        const plusOneNameDiv = document.getElementById('plusOneNameDiv');
        const transportDiv = document.getElementById('transportDiv');
        const plusOneNameInput = document.getElementById('plusOneName');
        const form = document.getElementById('rsvpForm');
        const submitButton = document.getElementById('submitButton');

        function updateFormFields() {
            const isAttending = attendingYes.checked || attendingPlusOne.checked;
            
            // Показываем/скрываем поле для имени +1
            if (attendingPlusOne.checked) {
                plusOneNameDiv.style.display = 'block';
                plusOneNameInput.setAttribute('required', 'required');
            } else {
                plusOneNameDiv.style.display = 'none';
                plusOneNameInput.removeAttribute('required');
                if (!attendingPlusOne.checked) {
                    plusOneNameInput.value = '';
                }
            }

            // Показываем/скрываем выбор транспорта
            if (isAttending) {
                transportDiv.style.display = 'block';
                document.querySelectorAll('input[name="needsTransport"]').forEach(radio => {
                    radio.setAttribute('required', 'required');
                });
            } else {
                transportDiv.style.display = 'none';
                document.querySelectorAll('input[name="needsTransport"]').forEach(radio => {
                    radio.removeAttribute('required');
                    radio.checked = false;
                });
            }
        }

        // Инициализация при загрузке страницы
        updateFormFields();

        // Обработчик изменения выбора
        document.querySelectorAll('input[name="attending"]').forEach(radio => {
            radio.addEventListener('change', updateFormFields);
        });

        // Валидация формы
        form.addEventListener('submit', function(e) {
            if (attendingPlusOne.checked && !plusOneNameInput.value.trim()) {
                e.preventDefault();
                alert('Пожалуйста, укажите имя +1');
                return;
            }

            const isAttending = attendingYes.checked || attendingPlusOne.checked;
            if (isAttending && !document.querySelector('input[name="needsTransport"]:checked')) {
                e.preventDefault();
                alert('Пожалуйста, выберите способ транспорта');
                return;
            }
        });

        // Автоматическое скрытие уведомления через 10 секунд
        const successAlert = document.querySelector('.alert-success');
        if (successAlert) {
            // Отключаем все поля формы
            const formElements = form.elements;
            for (let i = 0; i < formElements.length; i++) {
                formElements[i].disabled = true;
            }
            submitButton.disabled = true;
            submitButton.classList.add('disabled');

            setTimeout(() => {
                const bsAlert = new bootstrap.Alert(successAlert);
                bsAlert.close();
            }, 10000);
        }
    </script>
</body>
</html> 